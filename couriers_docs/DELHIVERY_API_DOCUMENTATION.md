# Delhivery Express API - Comprehensive Documentation

## Table of Contents

1. [Introduction](#introduction)
2. [Getting Started](#getting-started)
3. [Authentication](#authentication)
4. [Environment URLs](#environment-urls)
5. [Prerequisites for Integration](#prerequisites-for-integration)
6. [Business Terminology](#business-terminology)
7. [7 Steps of Integration](#7-steps-of-integration)
8. [API Endpoints Reference](#api-endpoints-reference)
9. [Package Lifecycle](#package-lifecycle)
10. [Best Practices](#best-practices)
11. [Error Handling](#error-handling)
12. [Support and Escalation](#support-and-escalation)

---

## Introduction

The Delhivery Express API is a REST-based API designed for last-mile delivery integration. It provides predictable, resource-oriented URLs and supports cross-origin resource sharing (CORS) for secure web application interactions.

### Key Features

- REST-based architecture
- JSON request/response format
- Support for both staging and production environments
- Comprehensive order lifecycle management
- Real-time tracking and webhook notifications
- Support for prepaid, COD, and reverse pickup shipments

### API Architecture

- **Base Protocol**: REST
- **Data Format**: JSON
- **Authentication**: Token-based
- **Rate Limiting**: Varies by endpoint (documented per API)

---

## Getting Started

### Overview

The Delhivery Express API enables developers to integrate shipping, tracking, and logistics solutions into their applications. The API covers the complete package lifecycle from order creation to delivery.

### Available Integrations

- **E-commerce Plugins**:
  - Magento
  - OpenCart
  - WooCommerce
  - Shopify
- **Custom Integration**: Using REST API endpoints

---

## Authentication

### API Token

Authentication is performed using a token-based system. Each client receives a unique API token.

#### Header Format

```
Authorization: Token XXXXXXXXXXXXXX
```

Replace `XXXXXXXXXXXXXX` with your actual API token.

### Obtaining API Tokens

Contact your Business Development (BD) or Customer Service (CS) relationship manager to obtain:
- Client account name (HQ name)
- Username
- Client ID
- API Token (12-16 character string)

### Important Notes

- **Different tokens for different environments**: You will receive separate tokens for staging/test and production environments
- **Security**: API tokens should NOT be shared with others
- **Token in all requests**: Must be included in the Authorization header for all API calls

---

## Environment URLs

### Staging/Test Environment

Used for testing API requests and responses before production deployment.

**Base URL**: `https://staging-express.delhivery.com`

**Sample Endpoints**:
- Gateway: `https://staging-express.delhivery.com`
- Waybill: `https://staging-express.delhivery.com/waybill/api/bulk/`
- Pincode: `https://staging-express.delhivery.com/c/api/pin-codes/`

### Production Environment

Used for live operations.

**Base URL**: `https://track.delhivery.com`

### Environment Switching

To switch from staging to production:
1. Change base URL from `staging-express.delhivery.com` to `track.delhivery.com`
2. Use production API token (different from staging token)

---

## Prerequisites for Integration

### Required Information

Before starting integration, ensure you have:

1. **Client Account Details**
   - Client account name (HQ name)
   - Username
   - Client ID
   - API Token for test environment
   - API Token for production environment

2. **Warehouse/Pickup Locations**
   - At least one registered pickup location
   - Can be created via:
     - Email to: `lastmile-integration@delhivery.com`
     - Warehouse Management API

3. **Minimum Balance**
   - Minimum wallet balance of 500 INR for prepaid accounts

### Technical Requirements

- Ability to make HTTP/HTTPS requests
- JSON parsing capability
- Secure storage for API tokens
- (Optional) Webhook endpoint for push notifications

---

## Business Terminology

Understanding key terms used throughout the Delhivery API ecosystem:

### Core Concepts

#### Waybill
- **Definition**: Unique tracking number assigned to every shipment in the Delhivery network
- **Also known as**: AWB (Air Waybill)
- **Generation**: Can be pre-fetched via API or auto-generated during order creation
- **Usage**: Primary identifier for tracking and managing shipments

#### Order ID
- **Definition**: Unique identifier associated with each shipment
- **Requirement**: Must be unique when waybill is not passed and is auto-generated by Delhivery
- **Uniqueness**: The combination of order ID + waybill serves as primary keys in the system

#### Token
- **Definition**: Authentication parameter for API access
- **Format**: 12-16 character string
- **Usage**: Required in Authorization header for all API calls

#### Pickup Location / Warehouse
- **Definition**: Physical location from where orders are picked up
- **Requirement**: Must be registered in Delhivery system before order creation
- **Note**: Only registered pickup locations can create orders

### Shipment Types

#### Single Piece Shipment
- One waybill represents a package
- Package can contain multiple items
- All items share the same waybill

#### Multi Piece Shipment
- Multiple boxes in one order
- Each box gets a separate waybill
- Used for orders that cannot fit in a single package

### Payment Modes

#### Prepaid
- **Definition**: Delivery of a package for which payment has already been made
- **Cash Collection**: No cash collection at delivery
- **Use Case**: Online paid orders

#### COD (Cash on Delivery)
- **Definition**: Delivery of a package for which cash needs to be collected
- **Cash Collection**: Payment collected from customer at delivery
- **Remittance**: Delhivery remits collected amount to merchant

#### Pickup
- **Definition**: Reverse logistics flow
- **Flow**: Customer location → Client warehouse
- **Use Case**: Returns, exchanges, sample collection

### Shipment Flows

#### Forward Flow
- **Direction**: Client warehouse → End customer
- **Payment Modes**: Prepaid or COD

#### Reverse Flow (RVP - Reverse Pickup)
- **Direction**: Customer location → Client warehouse
- **Payment Mode**: Pickup
- **Use Cases**: Product returns, exchanges, warranty claims

### Package Statuses

#### Status Types

- **UD**: Undelivered
- **DL**: Delivered
- **RT**: Returned
- **PP**: Pickup Pending
- **PU**: Picked Up
- **CN**: Canceled

#### Shipment States

**In-Transit States**:
- Manifested
- In Transit
- Pending
- Scheduled
- Dispatched
- Open

**Final States**:
- Delivered
- Cancelled
- RTO (Return to Origin)
- DTO (Deliver to Origin)
- Collected

### NDR (Non-Delivery Report)

- **Definition**: Report generated when delivery attempt fails
- **Common NDR Codes**:
  - EOD-74: Customer not available
  - EOD-15: Customer wants open delivery
  - EOD-11: Consignee refused to accept
  - EOD-3: Incorrect/incomplete address
  - EOD-16: Self collect requested
  - EOD-6: Door locked/house shut
  - ST-108: Delivery rescheduled
- **Actions Available**: Defer delivery date, Edit details, Re-attempt delivery

### Tax and Compliance

#### HSN Code
- **Definition**: Harmonized System of Nomenclature code
- **Requirement**: Mandatory for each product
- **Purpose**: Tax classification and compliance

#### GST Details
- **Seller GST TIN**: Mandatory in order creation
- **Consignee GST TIN**: Mandatory for B2B shipments
- **Purpose**: Tax compliance and invoicing

#### E-Waybill
- **Requirement**: Mandatory when shipment value exceeds 50,000 INR
- **Source**: Must be provided by client
- **Purpose**: Regulatory compliance

---

## 7 Steps of Integration

Delhivery's recommended integration workflow:

### Step 1: Pin-code Serviceability Check

**Purpose**: Verify if delivery address pincode is serviceable

**API**: Pincode Serviceability API

**Why Required**:
- Validates if Delhivery can deliver to the location
- Checks prepaid and COD availability
- Prevents order creation failures

**When to Call**: Before order creation, ideally at checkout

### Step 2: Warehouse/Pickup Location Creation

**Purpose**: Register physical pickup locations in Delhivery system

**Options**:
- Email warehouse details to `lastmile-integration@delhivery.com`
- Use Warehouse Creation API

**Requirement**: One-time activity, but mandatory before order creation

**Note**: Orders can only be created for registered warehouses

### Step 3: Pre-generated Waybill Acquisition (Optional)

**Purpose**: Fetch unique waybill numbers in advance

**API**: Bulk Waybill API or Fetch Waybill API

**Options**:
- **Pre-fetch**: Get waybills in advance and use in order creation
- **Auto-generate**: Leave blank in order creation, system assigns automatically

**Recommendation**: Auto-generation works for most B2C orders; pre-fetch required for multi-piece shipments

### Step 4: Package/Order Creation

**Purpose**: Push shipment soft data to Delhivery

**API**: Order Creation/Manifestation API

**Required Data**:
- Seller details
- Warehouse details
- Consignee name, phone, address
- Product details
- Payment mode
- GST and tax information

**Two Approaches**:
- Use pre-fetched waybill
- Let system auto-generate waybill

### Step 5: Shipping Label Generation

**Purpose**: Generate packing slip/shipping label

**API**: Packing Slip API

**Options**:
- Use Delhivery's Packing Slip API
- Create custom packing slip (must be validated with Delhivery)

**Note**:
- API returns JSON format
- Client needs to render into PDF/printable format
- Not required for return items

### Step 6: Pickup Request Creation

**Purpose**: Schedule pickup from warehouse

**API**: Pickup Request Creation API

**Required Information**:
- Pickup time
- Pickup date
- Warehouse name
- Quantity

**Notes**:
- Multiple pickup requests possible per day
- Can schedule from multiple warehouses simultaneously
- Can also be created via Client Panel (CL Panel)

### Step 7: Shipment Tracking

**Purpose**: Track order status and location

**API Options**:
- Pull API: Fetch tracking on demand
- Push API: Receive automatic updates via webhook

**Input Required**: Waybill number

**Tracking Limit**: Up to 30 waybills per request (Pull API)

### Additional Steps (Optional)

#### Step 8: Order Modification

**Purpose**: Edit or cancel orders

**API**: Edit/Cancel Order API

**Conditions**: Order must be in appropriate state
- Allowed states for cancellation: Manifested, In Transit, Pending, Open, Scheduled

**Outcomes**:
- Prepaid/COD packages → Status: Returned
- Pickup packages → Status: Cancelled

#### Step 9: NDR Management

**Purpose**: Handle non-delivery scenarios

**API**: Asynchronous NDR Package Action API

**Available Actions**:
- Defer delivery date
- Edit shipment details
- Re-attempt delivery

---

## API Endpoints Reference

### 1. Pincode Serviceability API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/c/api/pin-codes/json/`

**Production**: `https://track.delhivery.com/c/api/pin-codes/json/`

#### Method

`GET`

#### Purpose

Validates whether specific pincodes are serviceable by Delhivery.

#### Response

- JSON format
- List of all serviceable pincodes
- Flags indicating prepaid and COD serviceability
- "NSZ" response means pincode is not serviceable

#### Important Notes

- Mandatory to check before order creation
- Should be checked for each shipment
- Helps determine shipping feasibility

#### Use Case

```
Check if delivery to pincode 110001 is possible
→ API returns serviceability status
→ Show/hide COD option based on response
→ Proceed with order creation if serviceable
```

---

### 2. Bulk Waybill API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/waybill/api/bulk/json/`

**Production**: `https://track.delhivery.com/waybill/api/bulk/json/`

#### Method

`GET`

#### Purpose

Generates waybill numbers in bulk for advance storage and use.

#### Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| cl | String | Yes | Client name |
| token | String | Yes | API License key |
| count | Integer | Yes | Number of waybills to generate |

#### Request Example

```
https://track.delhivery.com/waybill/api/bulk/json/?cl=YOUR_CLIENT_NAME&token=YOUR_API_KEY&count=100
```

#### Limitations

- **Maximum per request**: 10,000 waybills
- **Maximum per 5 minutes**: 50,000 waybills

#### Important Notes

- Waybills from this API differ from initial onboarding files
- For orders without assigned waybills, order creation API can dynamically assign them
- Dynamic assignment works only for regular B2C orders, not multi-piece shipments

#### Response Format

JSON containing list of waybill numbers

---

### 3. Fetch Waybill API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/waybill/api/fetch/json/?cl=CLIENT_NAME`

**Production**: `https://track.delhivery.com/waybill/api/fetch/json/?cl=CLIENT_NAME`

#### Method

`GET`

#### Purpose

Fetches one waybill at a time, every time the API is hit.

#### Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| cl | String | Yes | Client name (in query string) |

#### Usage

- Single waybill per request
- Use when you need waybills one at a time
- Alternative to bulk waybill API for small volume operations

---

### 4. Client Warehouse Creation API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/api/backend/clientwarehouse/create/`

**Production**: `https://track.delhivery.com/api/backend/clientwarehouse/create/`

#### Method

`POST`

#### Purpose

Creates physical pickup locations/warehouses in Delhivery's system.

#### Important Notes

- Only registered pickup locations can create orders
- Warehouse creation is a one-time activity
- Integration is optional (Delhivery's FMS team can also create warehouses)
- Recommended for businesses needing dynamic pickup location addition
- Only predefined fields allowed in payload (no random key-value pairs)

#### Response

Successful response returns payload details with success message in JSON format.

#### Alternative

Send warehouse information to `lastmile-integration@delhivery.com`

---

### 5. Client Warehouse Edit API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/api/backend/clientwarehouse/edit/`

**Production**: `https://track.delhivery.com/api/backend/clientwarehouse/edit/`

#### Method

`POST`

#### Purpose

Changes existing warehouse details in Delhivery system.

#### Request Parameters

Based on available documentation, the edit API allows modification of warehouse details. Specific parameter details should be confirmed with Delhivery support.

---

### 6. Package Order Creation/Manifestation API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/api/cmu/create.json`

**Production**: `https://track.delhivery.com/api/cmu/create.json`

#### Method

`POST`

#### Purpose

Push shipment soft data to Delhivery system to create orders.

#### Key Requirements

##### Payload Format
- Must include `format=json&data=` in the request body
- No special characters: &, #, %, ;, \

##### Order ID
- Must be unique for every new order
- Especially when waybill is not passed
- When waybill not provided, system assigns randomly from Delhivery

##### Mandatory Fields
- PIN code
- Phone number
- Address
- Seller GST TIN
- HSN code
- Client name (must match registered name exactly - case sensitive)

#### Shipment Types

**Single Piece Shipment**:
- One waybill for multiple items in package

**Multi Piece Shipment**:
- Separate waybill for each box

#### Payment Modes

**Forward Shipments**:
- COD (Cash on Delivery)
- Prepaid

**Reverse Pickup**:
- Pickup

#### GST Details (Mandatory)

- `seller_gst_tin`: Seller's GST TIN number
- `consignee_gst_tin`: For B2B shipments
- `hsn_code`: Harmonized System of Nomenclature code

#### Optional but Recommended Fields

- `fragile_shipment`: Set to `true` for fragile items
- Complete GST information
- Maximum possible product details
- `invoice_reference`: Unique invoice reference number

#### Special Cases

**Bangladesh Shipments**:
- Country code "BD" must be specified
- Default is India if no country specified

**E-Waybill**:
- Required when shipment value exceeds 50,000 INR
- Must be passed from client end

**Quality Check (QC)**:
- Not required for Prepaid/COD orders
- Only required for reverse pickup if product verification needed

#### Prerequisites

- Pickup location must be registered in system
- Warehouse name in payload must match registered name exactly

#### Validation Rules

- Client name must match registration (case-sensitive)
- No special characters in payload
- Warehouse/pickup location must exist
- All mandatory fields must be present

#### Request Structure Elements

Key fields typically include:
- `shipments`: Array of shipment objects
- `pickup_location`: Warehouse details
- `consignee`: Customer details (name, phone, address, pin)
- `seller`: Seller details
- `order`: Order reference and payment details
- `products`: Product details with HSN codes
- `payment_mode`: COD/Prepaid/Pickup
- `order_id`: Unique order identifier
- `waybill`: Optional, auto-generated if not provided

---

### 7. Order Tracking API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/api/v1/packages/`

**Production**: `https://track.delhivery.com/api/v1/packages/`

#### Purpose

Retrieves package details and current status of shipments.

#### Tracking Methods

##### 1. Pull API

**Method**: `GET`

**Rate Limit**: 750 requests per 5 minutes per IP

**Usage**:
- Client actively requests package status
- Returns package scan details in response
- Supports up to 30 AWBs per request

##### 2. Push API (Webhook)

**Method**: `POST` (to client endpoint)

**Setup**: Client provides endpoint URL to Delhivery

**Benefit**: Automatic push of package scan updates

**See**: [Tracking via Push API/Webhook](#10-tracking-via-push-api-webhook) section

#### Package Types Supported

- Pre-paid (payment already made)
- COD (cash on delivery)
- Pickup (reverse pickup)

#### Input Required

- Waybill number(s)

---

### 8. Cancel Order API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/api/p/edit`

**Production**: `https://track.delhivery.com/api/p/edit`

#### Method

`POST`

#### Purpose

Facilitates cancellation of existing packages/orders.

#### Request Format

- **Payload Format**: JSON
- **Response Format**: JSON

#### Cancellation Key

```json
{
  "cancellation": "true"
}
```

#### Allowed Package Statuses for Cancellation

1. Manifested
2. In Transit
3. Pending
4. Open
5. Scheduled

#### Cancellation Outcomes

**Prepaid/COD Packages**:
- Status changes to → **Returned**

**Pickup Packages**:
- Status changes to → **Cancelled**

#### Important Notes

- Order must be in appropriate state to be cancelled
- This is an "advance API integration" method
- Can also cancel via CL Panel (Client Panel)

---

### 9. Asynchronous NDR Package Action API

#### Endpoint

**NDR API (Action)**:

**Test**: `https://staging-express.delhivery.com/api/p/update`

**Production**: `https://track.delhivery.com/api/p/update`

#### Method

`POST`

#### Purpose

Allows actions on NDR (Non-Delivery Report) packages.

#### Available Actions

##### 1. DEFER_DLV - Deferred Delivery Date

**Action Code**: `DEFER_DLV`

**Parameters**:

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| waybill | String | Yes | Waybill number of package |
| act | String | Yes | Action keyword: "DEFER_DLV" |
| deferred_date | String | Yes | Date in "YYYY-MM-DD" format |

**Constraints**:
- Maximum deferral: 6 days from first pending date
- Allowed status codes: EOD-74, EOD-15, EOD-11, EOD-3, EOD-16, EOD-6, ST-108

**Use Case**: Customer requests delivery on specific future date

---

##### 2. EDIT_DETAILS - Edit Package Details

**Action Code**: `EDIT_DETAILS`

**Parameters**:

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| waybill | String | Yes | Waybill number of package |
| act | String | Yes | Action keyword: "EDIT_DETAILS" |
| name | String | Optional | Consignee name |
| phone | String | Optional | Consignee phone number |
| add | String | Optional | Consignee address |

**Constraints**:
- Only applicable when package is in pending status
- Allows partial updates

**Use Case**: Customer provides corrected address or contact details

---

##### 3. RE-ATTEMPT - Reattempt Delivery

**Action Code**: `RE-ATTEMPT`

**Parameters**:

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| waybill | String | Yes | Waybill number of package |
| act | String | Yes | Action keyword: "RE-ATTEMPT" |

**Constraints**:
- Package must be in pending status
- Allowed status codes: EOD-74, EOD-15, EOD-104, EOD-43, EOD-86, EOD-11, EOD-16, EOD-69, EOD-6, ST-108

**Use Case**: Customer confirms availability for re-delivery

---

#### NDR API Characteristics

- **Asynchronous**: Operations processed asynchronously
- **Partial Updates**: Allows updating only specific fields
- **UPL ID**: Returns UPL ID in response for tracking action status

#### Get NDR Status API

After performing an NDR action, use the UPL ID to check status:

**Purpose**: Check status of UPL ID received from NDR API

**Note**: Specific endpoint details to be confirmed with Delhivery support

---

### 10. Tracking via Push API (Webhook)

#### Endpoint

**Client Provided**: You must provide an open endpoint URL to receive webhooks

#### Method

`POST` (Delhivery → Your Server)

#### Purpose

Receive real-time automatic updates when package scan status changes.

#### How It Works

1. Client provides an endpoint URL to Delhivery
2. Delhivery configures the endpoint in client configuration
3. Every time a scan is applied to package, Delhivery sends update to your endpoint
4. Your endpoint should respond with "200 OK"

#### Setup Requirements

**To Enable Webhooks, Provide**:
- API endpoint URL (must be publicly accessible)
- 1-2 live waybills/tracking IDs for testing
- curl request example with expected response

#### Webhook Payload Example

```json
{
    "Shipment": {
        "Status": {
            "Status": "Manifested",
            "StatusDateTime": "2019-01-09T17:10:42.767",
            "StatusType": "UD",
            "StatusLocation": "Chandigarh_Raiprkln_C (Chandigarh)",
            "Instructions": "Manifest uploaded"
        },
        "PickUpDate": "2019-01-09T17:10:42.543",
        "NSLCode": "X-UCI",
        "Sortcode": "IXC/MDP",
        "ReferenceNo": "28",
        "AWB": "XXXXXXXXXXXX"
    }
}
```

#### Expected Response

Your endpoint must return:

```
HTTP/1.1 200 OK
```

#### Implementation Timeline

- Development and testing: 5-6 working days
- After testing approval, webhook goes live

#### Best Practices

**Recommended Approach**:
- Consume all scans pushed by Delhivery
- Do not put hard checks initially
- Process and store all webhook data
- Handle idempotency (same event might be sent multiple times)

**Error Handling**:
- Implement retry logic on your end
- Log all incoming webhooks
- Monitor for missing updates

---

### 11. Packing Slip Creation API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/api/p/packing_slip?wbns=WAYBILL`

**Production**: `https://track.delhivery.com/api/p/packing_slip?wbns=WAYBILL`

#### Method

`GET`

#### Purpose

Provides packing slip data for a waybill number.

#### Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| wbns | String | Yes | Waybill number |

#### Response

- **Format**: JSON
- **Rendering**: Client must convert JSON to HTML/PDF
- **Encoding**: Uses encoding 128
- **Layout**: Requires appropriate packing slip layout rendering

#### Important Notes

- Not mandatory - can create custom packing slip
- If creating custom slip, must validate with Delhivery
- Not required for return items
- Can also fetch shipping label from CL Panel
- Sample packing slip design provided in documentation

#### Alternative

Use Client Panel (CL Panel) to generate and download packing slips directly.

---

### 12. Invoice - Shipping Charge API

#### Endpoint

**Production**: `https://track.delhivery.com/api/kinko/v1/invoice/charges/.json`

#### Method

`GET` (details to be confirmed)

#### Purpose

Calculate approximate shipping charges for shipments.

#### Rate Limit

**40 requests per minute**

IP will be throttled after exceeding limit.

#### Request Parameters (Mandatory)

| Parameter | Type | Description | Values |
|-----------|------|-------------|---------|
| md | String | Billing Mode of shipment | E or S |
| cgm | Integer | Chargeable weight in grams | Default: 0 |
| o_pin | Integer | Origin pincode (6 digits) | - |
| d_pin | Integer | Destination pincode (6 digits) | - |
| ss | String | Shipment status | Delivered, RTO, DTO |

#### Response

Returns:
- Gross amount
- Taxes
- **Total amount** (gross + taxes)

#### Important Notes

**Approximate Values Only**:
- Provides rough shipping charge estimates
- Actual charged amount may differ from calculated amount
- Total_amount should be considered approximate

**Use Cases**:
- Display estimated shipping cost at checkout
- Internal cost calculations
- Pricing comparison

---

### 13. Pickup Request Creation API

#### Endpoint

**Test**: `https://staging-express.delhivery.com/fm/request/new/`

**Production**: `https://track.delhivery.com/fm/request/new/`

#### Method

`POST` (to be confirmed)

#### Purpose

Inform Delhivery to pickup orders from warehouse.

#### Required Inputs

1. **Pickup time**
2. **Pickup date**
3. **Warehouse name**
4. **Quantity** (number of packages)

#### Important Notes

- Optional API (can also create via CL Panel)
- Multiple pickup requests can be made in one day
- Only after one pickup request is completed
- Multiple warehouses can have simultaneous pickup requests

#### Alternative

Create pickup requests via Client Panel (CL Panel).

---

## Package Lifecycle

### Overview

The package lifecycle represents the journey from order placement to final delivery or return.

### Lifecycle Stages

```
Order Placement
    ↓
Pincode Serviceability Check
    ↓
Waybill Generation
    ↓
Order Manifestation
    ↓
Packing Slip Creation
    ↓
Pickup Scheduling
    ↓
Pickup from Warehouse
    ↓
In Transit (Hub to Hub)
    ↓
Out for Delivery
    ↓
Delivery Attempt
    ↓
[Success] → Delivered (Final)
[Failure] → NDR → Re-attempt or RTO
```

### Status Progression

#### Initial States

1. **Manifested**: Order created in system, awaiting pickup
2. **Pickup Pending (PP)**: Pickup scheduled but not yet collected
3. **Picked Up (PU)**: Package collected from warehouse

#### Transit States

4. **In Transit**: Package moving through Delhivery network
5. **Dispatched**: Package sent to delivery hub
6. **Out for Delivery**: Package assigned to delivery executive
7. **Scheduled**: Delivery scheduled for specific time/date

#### Delivery Attempt States

8. **Pending**: Delivery attempted but unsuccessful (NDR generated)
9. **Open**: Package status being updated

#### Final States

10. **Delivered (DL)**: Successfully delivered to customer
11. **Returned (RT)**: Package returned to sender
12. **RTO (Return to Origin)**: Package being returned to seller
13. **DTO (Deliver to Origin)**: Package delivered back to origin
14. **Cancelled (CN)**: Order cancelled
15. **Collected**: Reverse pickup collected from customer

### Status Types

- **UD**: Undelivered
- **DL**: Delivered
- **RT**: Returned
- **PP**: Pickup Pending
- **PU**: Picked Up
- **CN**: Canceled

### Shipment Flows

#### Forward Flow (Standard Delivery)

```
Client Warehouse → Delhivery Pickup → Transit → Delivery Hub → Customer
```

**Characteristics**:
- Payment mode: Prepaid or COD
- Direction: Seller to buyer
- Primary use: E-commerce orders

#### Reverse Flow (Returns/Pickups)

```
Customer Location → Delhivery Pickup → Transit → Delivery Hub → Client Warehouse
```

**Characteristics**:
- Payment mode: Pickup
- Direction: Buyer to seller
- Use cases: Returns, exchanges, warranty, samples

---

## Best Practices

### General API Best Practices

#### 1. Understand REST URL Call Types

- Identify whether endpoint is GET or POST
- Use appropriate HTTP method for each API call

#### 2. Authentication

- For POST URLs, always include authorization key
- Format: `Authorization: Token [api-key-token]`
- Keep tokens secure and never expose in client-side code

#### 3. Environment Testing

- **Thoroughly test in staging** before production
- Test all scenarios including edge cases
- Verify error handling
- Test with realistic data volumes

#### 4. URL Structure

Production URLs are similar to staging but use different base:
- **Staging**: `https://staging-express.delhivery.com`
- **Production**: `https://track.delhivery.com`

#### 5. Use Swagger/API Testing Tools

- Use "Try it" button in documentation
- Review all possible error scenarios
- Understand response codes
- Pay attention to "Required" fields

### Integration Best Practices

#### 1. Mandatory Serviceability Check

- **Always check pincode serviceability** before order creation
- Check for each order, not just once
- Use results to show/hide COD option

#### 2. Warehouse Management

- Register warehouses before integration testing
- Ensure warehouse names match exactly (case-sensitive)
- Maintain warehouse name consistency across all API calls

#### 3. Waybill Management

**Options**:
- **Auto-generation** (recommended for most cases): Leave waybill blank in order creation
- **Pre-fetch**: Use bulk waybill API for multi-piece shipments

**Best Practice**: Use auto-generation unless specific requirements dictate otherwise

#### 4. Order Creation

**Mandatory Fields Checklist**:
- ✓ PIN code
- ✓ Phone number (10 digits)
- ✓ Complete address
- ✓ Seller GST TIN
- ✓ HSN code for each product
- ✓ Correct client name (matches registration)

**Payload Requirements**:
- Include `format=json&data=` in payload
- Avoid special characters: &, #, %, ;, \
- Ensure JSON is properly formatted

#### 5. Wallet Balance

- Maintain minimum 500 INR balance for prepaid accounts
- Monitor balance regularly
- Set up low balance alerts

#### 6. Error Handling

**Common Errors and Solutions**:

| Error | Cause | Solution |
|-------|-------|----------|
| "shipment list contains no data" | Client name mismatch | Verify client name matches registration |
| "ClientWarehouse doesn't exist" | Wrong warehouse name | Use exact warehouse name from system |
| Special character errors | Invalid characters in payload | Remove &, \, %, #, ; characters |
| Payload format error | Missing format parameter | Add "format=json&data=" |

#### 7. Tracking Implementation

**Choose Based on Need**:

**Pull API** (Polling):
- Good for: Low-frequency updates, on-demand tracking
- Limit: 750 requests per 5 minutes
- Use case: Customer checks tracking page

**Push API** (Webhook):
- Good for: Real-time updates, automated workflows
- Setup time: 5-6 working days
- Use case: Automatic status notifications to customers

**Recommendation**: Implement both for best experience

#### 8. NDR Handling

- Set up automated NDR notifications to customers
- Provide customer portal for NDR actions
- Implement re-attempt scheduling
- Monitor NDR rates and reasons

#### 9. Testing Checklist

Before going live, test:
- [ ] Pincode serviceability check
- [ ] Order creation (prepaid)
- [ ] Order creation (COD)
- [ ] Order creation (reverse pickup)
- [ ] Multi-piece shipments
- [ ] Order tracking
- [ ] Order cancellation
- [ ] NDR actions
- [ ] Webhook reception (if implemented)
- [ ] Error scenarios
- [ ] High-volume order creation

### Support Channel Usage

**Operational Queries**:
- Email: `bdspoc@delhivery.com`
- Use for: Billing, service issues, general operations

**Technical Queries**:
- Email: `lastmile-integration@delhivery.com`
- Use for: API integration, technical issues, plugin problems

**Best Practice**:
- Provide complete error details
- Include request/response samples
- Mention environment (staging/production)
- Include timestamp and waybill/order details

### Documentation Review

- Carefully review API documentation before implementation
- Bookmark frequently used endpoints
- Keep updated with API changes
- Download Postman collection for testing

---

## Error Handling

### Common API Errors

#### 1. Authentication Errors

**Symptom**: 401 Unauthorized

**Causes**:
- Invalid API token
- Missing Authorization header
- Using wrong environment token

**Solution**:
- Verify token is correct
- Check header format: `Authorization: Token XXXXXX`
- Ensure using correct token for environment (staging vs production)

#### 2. Payload Errors

**Symptom**: "shipment list contains no data"

**Causes**:
- Client name doesn't match registration
- Incorrect payload format

**Solution**:
- Verify client name matches exactly (case-sensitive)
- Include `format=json&data=` in payload

#### 3. Warehouse Errors

**Symptom**: "ClientWarehouse matching query doesn't exist"

**Causes**:
- Warehouse name doesn't match registered name
- Warehouse not created in system

**Solution**:
- Use exact warehouse name from system
- Verify warehouse is registered
- Check spelling and case sensitivity

#### 4. Special Character Errors

**Symptom**: Payload parsing errors

**Causes**:
- Special characters in data: &, #, %, ;, \

**Solution**:
- Remove or URL-encode special characters
- Sanitize input data before API call

#### 5. Validation Errors

**Symptom**: Missing mandatory field errors

**Causes**:
- Required fields not provided
- Fields in wrong format

**Solution**:
- Check all mandatory fields are present
- Verify data types match requirements
- Validate phone numbers (10 digits)
- Validate PIN codes (6 digits)
- Ensure dates in correct format (YYYY-MM-DD)

#### 6. Rate Limiting

**Symptom**: 429 Too Many Requests

**Causes**:
- Exceeded rate limit for endpoint

**Solutions**:
- Implement exponential backoff
- Respect rate limits:
  - Bulk Waybill: 50,000 per 5 minutes
  - Order Tracking (Pull): 750 per 5 minutes
  - Invoice Calculation: 40 per minute

#### 7. Waybill Errors

**Symptom**: Waybill generation failures

**Causes**:
- Requesting too many waybills
- Invalid client name

**Solution**:
- Respect limits (10,000 per request, 50,000 per 5 min)
- Verify client name parameter

#### 8. Order State Errors

**Symptom**: Cannot edit/cancel order

**Causes**:
- Order not in editable state
- Order already delivered/cancelled

**Solution**:
- Check current order status
- Only attempt edits when order is in:
  - Manifested
  - In Transit
  - Pending
  - Open
  - Scheduled

### Error Response Handling

#### Standard Error Response Format

```json
{
    "error": "Error message",
    "status_code": 400,
    "details": "Additional details about the error"
}
```

#### Recommended Error Handling Flow

```
1. Make API Call
    ↓
2. Check HTTP Status Code
    ↓
3. If 2xx → Success, process response
    ↓
4. If 4xx → Client error
    ├─ 400: Bad Request → Fix payload
    ├─ 401: Unauthorized → Fix authentication
    ├─ 404: Not Found → Check endpoint URL
    └─ 429: Rate Limited → Implement backoff
    ↓
5. If 5xx → Server error
    └─ Retry with exponential backoff
    ↓
6. Log error for debugging
    ↓
7. Show user-friendly message
```

### Retry Strategy

#### When to Retry

- 5xx errors (server errors)
- Network timeouts
- Connection failures

#### When NOT to Retry

- 4xx errors (fix the request instead)
- Authentication failures (update credentials)
- Validation errors (fix data)

#### Recommended Retry Logic

```
Attempt 1: Immediate
Attempt 2: Wait 1 second
Attempt 3: Wait 2 seconds
Attempt 4: Wait 4 seconds
Attempt 5: Wait 8 seconds
Max Attempts: 5
```

---

## Support and Escalation

### Support Channels

#### Technical Support

**Email**: `lastmile-integration@delhivery.com`

**Use For**:
- API integration issues
- Plugin issues
- Technical errors
- Webhook setup
- API documentation questions
- Development support

**Response Time**: Typically 1-2 business days

---

#### Operational Support

**Email**: `bdspoc@delhivery.com`

**Use For**:
- All operational queries
- Billing questions
- Service issues
- Account management
- General inquiries

**Response Time**: Typically 1-2 business days

---

### When Contacting Support

#### Information to Include

1. **Environment Details**
   - Staging or Production
   - API endpoint being called
   - Timestamp of issue

2. **Request Details**
   - Full request (sanitize sensitive data)
   - Headers (excluding API token)
   - Request payload

3. **Response Details**
   - HTTP status code
   - Response body
   - Error messages

4. **Order/Waybill Details** (if applicable)
   - Order ID
   - Waybill number
   - Client name

5. **What You've Tried**
   - Troubleshooting steps taken
   - Previous working state (if applicable)

#### Support Request Template

```
Subject: [Environment] - Brief Description of Issue

Environment: [Staging/Production]
API Endpoint: [Full URL]
HTTP Method: [GET/POST]
Timestamp: [YYYY-MM-DD HH:MM:SS]

Issue Description:
[Detailed description of the problem]

Request Details:
[Sanitized request payload]

Response Received:
[Status code and response body]

Steps to Reproduce:
1. [Step 1]
2. [Step 2]
3. [Step 3]

Expected Behavior:
[What should happen]

Actual Behavior:
[What actually happens]

Additional Context:
[Any other relevant information]

Order/Waybill Details (if applicable):
- Order ID: [ID]
- Waybill: [Number]
- Client Name: [Name]
```

---

### Escalation Matrix

#### Level 1: Email Support

**Contact**:
- Technical: `lastmile-integration@delhivery.com`
- Operational: `bdspoc@delhivery.com`

**For**: Routine queries and issues

---

#### Level 2: Account Manager

**Contact**: Your assigned Business Development (BD) or Customer Service (CS) relationship manager

**For**:
- Unresolved issues after 2 business days
- Account-related concerns
- Service level discussions

---

### Additional Resources

#### Developer Portal

**URL**: `https://ucp.delhivery.com/developer-portal/v1/execute`

**Features**:
- Test APIs with staging environment
- View API request/response structures
- Validate API functionality

**Access**: Login with your Delhivery credentials

---

#### Official Documentation

**URL**: `https://delhivery-express-api-doc.readme.io`

**Contents**:
- Complete API reference
- Integration guides
- FAQs
- Code samples

---

#### Alternative Documentation Portal

**URL**: `https://one.delhivery.com/developer-portal/documents`

**Access**: Via Delhivery One platform

---

### Testing Support

#### Postman Collection

- Download Postman collection for API testing
- Pre-configured requests for all endpoints
- Environment variables for easy switching

#### Sample Data

- Request sample waybills for testing
- Use staging environment for integration testing
- Test with realistic scenarios

---

## Appendix

### Quick Reference: API Endpoints Summary

| API | Method | Staging URL | Production URL |
|-----|--------|-------------|----------------|
| Pincode Serviceability | GET | staging-express.delhivery.com/c/api/pin-codes/json/ | track.delhivery.com/c/api/pin-codes/json/ |
| Bulk Waybill | GET | staging-express.delhivery.com/waybill/api/bulk/json/ | track.delhivery.com/waybill/api/bulk/json/ |
| Fetch Waybill | GET | staging-express.delhivery.com/waybill/api/fetch/json/ | track.delhivery.com/waybill/api/fetch/json/ |
| Create Warehouse | POST | staging-express.delhivery.com/api/backend/clientwarehouse/create/ | track.delhivery.com/api/backend/clientwarehouse/create/ |
| Edit Warehouse | POST | staging-express.delhivery.com/api/backend/clientwarehouse/edit/ | track.delhivery.com/api/backend/clientwarehouse/edit/ |
| Create Order | POST | staging-express.delhivery.com/api/cmu/create.json | track.delhivery.com/api/cmu/create.json |
| Track Order | GET | staging-express.delhivery.com/api/v1/packages/ | track.delhivery.com/api/v1/packages/ |
| Cancel Order | POST | staging-express.delhivery.com/api/p/edit | track.delhivery.com/api/p/edit |
| NDR Action | POST | staging-express.delhivery.com/api/p/update | track.delhivery.com/api/p/update |
| Packing Slip | GET | staging-express.delhivery.com/api/p/packing_slip | track.delhivery.com/api/p/packing_slip |
| Shipping Charges | GET | - | track.delhivery.com/api/kinko/v1/invoice/charges/.json |
| Pickup Request | POST | staging-express.delhivery.com/fm/request/new/ | track.delhivery.com/fm/request/new/ |

### Rate Limits

| API | Limit |
|-----|-------|
| Bulk Waybill | 10,000 per request; 50,000 per 5 minutes |
| Order Tracking (Pull) | 750 requests per 5 minutes per IP |
| Shipping Charge Calculation | 40 requests per minute |

### Common Status Codes

| Code | Meaning | Description |
|------|---------|-------------|
| 200 | OK | Request successful |
| 400 | Bad Request | Invalid request format or parameters |
| 401 | Unauthorized | Invalid or missing API token |
| 404 | Not Found | Endpoint or resource not found |
| 429 | Too Many Requests | Rate limit exceeded |
| 500 | Internal Server Error | Server-side error, retry |
| 503 | Service Unavailable | Service temporarily down |

### NDR Status Codes

| Code | Description |
|------|-------------|
| EOD-74 | Customer not available |
| EOD-15 | Customer wants open delivery |
| EOD-11 | Consignee refused to accept |
| EOD-3 | Incorrect/incomplete address |
| EOD-16 | Self collect requested |
| EOD-6 | Door locked/house shut |
| EOD-104 | Delivery rescheduled by customer |
| EOD-43 | Customer not reachable |
| EOD-86 | Wrong recipient |
| EOD-69 | Damaged product |
| ST-108 | Delivery rescheduled |

### Contact Directory

| Purpose | Email |
|---------|-------|
| Technical Support / API Integration | lastmile-integration@delhivery.com |
| Operational Support | bdspoc@delhivery.com |
| Warehouse Creation (Alternative) | lastmile-integration@delhivery.com |

---

## Document Version

**Version**: 1.0

**Last Updated**: 2025-10-02

**Based On**: Delhivery Express API Documentation (delhivery-express-api-doc.readme.io)

**Compiled By**: Claude Code Assistant

**Note**: This documentation is compiled from publicly available Delhivery Express API documentation. For the most up-to-date information, always refer to the official Delhivery API documentation at https://delhivery-express-api-doc.readme.io or contact Delhivery support.

---

## Changelog

### Version 1.0 (2025-10-02)
- Initial comprehensive documentation
- Compiled all API endpoints
- Added integration guides
- Included best practices
- Added error handling guide
- Created quick reference tables

---

**END OF DOCUMENT**
